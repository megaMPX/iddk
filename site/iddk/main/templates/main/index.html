{% extends 'main/layot.html' %}

{% block title %}–ì–ª–∞–≤–Ω–∞—è{% endblock %}

{% block content %}
    <div class="features">
        <!--<button class="about-button">–ù–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –ø—Ä–æ –Ω–∞—Å</button>-->
    </div>

    <!-- –°–ª–∞–π–¥–µ—Ä -->
    <div class="slider-container">
        <div id="imageCarousel" class="carousel slide" data-bs-ride="carousel" data-bs-interval="5000">
            <div class="carousel-inner">
                {% for slider_image in slider_images %}
                    <div class="carousel-item {% if forloop.first %}active{% endif %}">
                        <img src="{{ slider_image.image.url }}" class="d-block w-100" alt="{{ slider_image.title }}" style="max-height: 300px; object-fit: cover;">
                    </div>
                {% endfor %}
            </div>
            <button class="carousel-control-prev" type="button" data-bs-target="#imageCarousel" data-bs-slide="prev">
                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                <span class="visually-hidden">–ü—Ä–µ–¥—ã–¥—É—â–∏–π</span>
            </button>
            <button class="carousel-control-next" type="button" data-bs-target="#imageCarousel" data-bs-slide="next">
                <span class="carousel-control-next-icon" aria-hidden="true"></span>
                <span class="visually-hidden">–°–ª–µ–¥—É—é—â–∏–π</span>
            </button>
            
            <!-- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã (—Ç–æ—á–∫–∏) -->
            <div class="carousel-indicators">
                {% for slider_image in slider_images %}
                    <button type="button" data-bs-target="#imageCarousel" data-bs-slide-to="{{ forloop.counter0 }}" class="{% if forloop.first %}active{% endif %}" aria-current="{% if forloop.first %}true{% endif %}" aria-label="–°–ª–∞–π–¥ {{ forloop.counter }}"></button>
                {% endfor %}
            </div>
        </div>
    </div>

   <div class="news-section">
    <h3>–ù–æ–≤–∏–Ω–∫–∏</h3>
    <ul class="news-list">
        {% for item in news %}
        <li class="news-item" onclick="openModal('{{ item.images.first.image.url }}', '{{ item.content|escapejs }}', {{ item.audios.count }}, '{% for audio in item.audios.all %}{{ audio.audio.url }}{% if not forloop.last %}|{% endif %}{% endfor %}', '{{ item.book_code }}')">            
            {% if item.images.count > 0 %}
                <div class="news-image">
                    {% for image in item.images.all %}
                        <img src="{{ image.image.url }}" alt="{{ item.title }}" class="img-fluid" style="border-radius: 10px; cursor: pointer;">
                    {% endfor %}
                </div>
            {% endif %}
            
            <h3 class="news-title" style="color:#003456;">{{ item.title }}</h3>
            <p class="news-author">–ê–≤—Ç–æ—Ä: {{ item.author }}</p>
            
            {% if item.book_type == 'üéß–ê—É–¥–∏–æ' %}  <!-- –£—Å–ª–æ–≤–∏–µ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ç–∏–ø–∞ –∫–Ω–∏–≥–∏ -->
                <p class="news-reader">–ß—Ç–µ—Ü: {{ item.reader }}</p> <!-- –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —á—Ç–µ—Ü–∞ —Ç–æ–ª—å–∫–æ –¥–ª—è –∞—É–¥–∏–æ–∫–Ω–∏–≥ -->
            {% endif %}
            
            <p class="news-date">{{ item.published_date|date:"d.m.Y" }}</p> 
            <p class="news-type oval">{{ item.book_type }}</p>  
        </li>
        {% empty %}
            <li style="text-align: center; color: #888;">–ù–µ—Ç –Ω–æ–≤–æ—Å—Ç–µ–π –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è.</li>
        {% endfor %}
    </ul>
</div>
<div id="imageModal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background-color:rgba(0, 0, 0, 0.5); backdrop-filter: blur(10px); z-index:1000; justify-content:center; align-items:flex-start;">
    <div style="background-color: white; border-radius: 15px; padding: 20px; max-width: 95%; width: 100%; box-shadow: 0 4px 20px rgba(0,0,0,0.2); overflow: hidden; position: relative; margin-top: 20px;">
        <span style="color:black; font-size:30px; position:absolute; top:10px; right:10px; cursor:pointer;" onclick="closeModal()">√ó</span>
        <div id="modalContentWrapper" style="display: flex; align-items: stretch; padding-top: 20px;">
            <img id="modalImage" src="" alt="Full size" style="flex: 1; max-height: 80vh; max-width: 100%; object-fit: contain; margin-right: 20px;">
            <div id="modalText" style="flex: 1; color: black; padding: 10px; overflow-y: auto; max-height: 80vh;">
                <div id="modalContent" style="margin: 0; white-space: pre;"></div>
                <div id="audioControls" style="margin-top: 10px;"></div> <!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –∫–Ω–æ–ø–∫–∏ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è -->
                <div id="modalBookCode" style="color: #3a3a3a; margin-top: 10px; font-size: small; padding: 10px; border: 1px solid #007bff; border-radius: 5px; background-color: #f0f8ff; display: inline-block;">
                    –ö–æ–¥: <span id="bookCode"></span>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
    /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ */
    @media (max-width: 768px) {
        #modalContentWrapper {
            flex-direction: column; /* –ò–∑–º–µ–Ω—è–µ–º –ø–æ—Ä—è–¥–æ–∫ –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ */
            align-items: center; /* –¶–µ–Ω—Ç—Ä–∏—Ä—É–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã */
            max-height: 80vh; /* –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –≤—ã—Å–æ—Ç—É —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–≥–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ */
            overflow-y: auto; /* –î–æ–±–∞–≤–ª—è–µ–º –ø—Ä–æ–∫—Ä—É—Ç–∫—É */
        }
        #modalImage {
            max-height: 50vh; /* –£–º–µ–Ω—å—à–∞–µ–º –≤—ã—Å–æ—Ç—É –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö */
            width: 100%; /* –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —à–∏—Ä–∏–Ω—É –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–∞ 100% */
            margin-bottom: 10px; /* –î–æ–±–∞–≤–ª—è–µ–º –æ—Ç—Å—Ç—É–ø —Å–Ω–∏–∑—É */
        }
        #modalText {
            text-align: left; /* –£–±–∏—Ä–∞–µ–º —Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ */
            width: 100%; /* –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —à–∏—Ä–∏–Ω—É —Ç–µ–∫—Å—Ç–∞ –Ω–∞ 100% */
            padding: 10px; /* –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º –æ—Ç—Å—Ç—É–ø –¥–ª—è —Ç–µ–∫—Å—Ç–∞ */
        }
    }
</style>
<div id="imageModal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background-color:rgba(0, 0, 0, 0.5); backdrop-filter: blur(10px); z-index:1000; justify-content:center; align-items:flex-start;">
    <div style="background-color: white; border-radius: 15px; padding: 20px; max-width: 95%; width: 100%; box-shadow: 0 4px 20px rgba(0,0,0,0.2); overflow: hidden; position: relative; margin-top: 20px;">
        <span style="color:black; font-size:30px; position:absolute; top:10px; right:10px; cursor:pointer;" onclick="closeModal()">√ó</span>
        <div id="modalContentWrapper" style="display: flex; align-items: flex-start; padding-top: 20px; width: 100%; box-sizing: border-box;">
            <img id="modalImage" src="" alt="Full size" style="flex: 1; max-height: 50vh; max-width: 50%; object-fit: contain; margin-right: 20px;">
            <div id="modalText" style="flex: 1; color: black; padding: 10px; box-sizing: border-box; word-wrap: break-word; overflow-wrap: break-word; word-break: break-all; white-space: normal;">
                <div id="modalContent" style="margin: 0; width: 100%; overflow-wrap: break-word; word-break: break-all; white-space: normal;">
                    –≠—Ç–æ –ø—Ä–∏–º–µ—Ä —Ç–µ–∫—Å—Ç–∞, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–Ω–æ—Å–∏—Ç—å—Å—è –Ω–∞ —Å–ª–µ–¥—É—é—â—É—é —Å—Ç—Ä–æ–∫—É, —á—Ç–æ–±—ã –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –¥–æ–±–∞–≤–∏—Ç—å –¥–ª–∏–Ω–Ω—ã–µ —Å–ª–æ–≤–∞, —Ç–∞–∫–∏–µ –∫–∞–∫ "–¥–ª–∏–Ω–Ω–æ—Å–ª–æ–≤–æ—Å–æ—Å—Ç–∞–≤–ª—è—é—â–µ–µ", —á—Ç–æ–±—ã —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –ø–µ—Ä–µ–Ω–æ—Å —Ä–∞–±–æ—Ç–∞–µ—Ç.
                </div>
                <div id="audioControls" style="margin-top: 10px;"></div>
                <div id="modalBookCode" style="color: #3a3a3a; margin-top: 10px; font-size: small; padding: 10px; border: 1px solid #007bff; border-radius: 5px; background-color: #f0f8ff; display: inline-block;">
                    –ö–æ–¥: <span id="bookCode"></span>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
    /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ */
    @media (max-width: 768px) {
        #modalContentWrapper {
            flex-direction: column; /* –ò–∑–º–µ–Ω—è–µ–º –ø–æ—Ä—è–¥–æ–∫ –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ */
            align-items: center; /* –¶–µ–Ω—Ç—Ä–∏—Ä—É–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã */
            width: 100%; /* –®–∏—Ä–∏–Ω–∞ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–≥–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ */
        }
        #modalImage {
            max-height: 50vh; /* –£–º–µ–Ω—å—à–∞–µ–º –≤—ã—Å–æ—Ç—É –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö */
            width: 100%; /* –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —à–∏—Ä–∏–Ω—É –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–∞ 100% */
            margin-bottom: 10px; /* –î–æ–±–∞–≤–ª—è–µ–º –æ—Ç—Å—Ç—É–ø —Å–Ω–∏–∑—É */
        }
        #modalText {
            flex: 1;
            color: black;
            padding: 10px;
            overflow: hidden; /* –£–±–∏—Ä–∞–µ–º –ø—Ä–æ–∫—Ä—É—Ç–∫—É */
            width: 100%; /* –®–∏—Ä–∏–Ω–∞ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ */
            box-sizing: border-box; /* –£—á–∏—Ç—ã–≤–∞–µ–º padding –≤ —à–∏—Ä–∏–Ω–µ */
            word-wrap: break-word; /* –ü–µ—Ä–µ–Ω–æ—Å –¥–ª–∏–Ω–Ω—ã—Ö —Å–ª–æ–≤ */
            overflow-wrap: break-word; /* –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –ø–µ—Ä–µ–Ω–æ—Å –¥–ª–∏–Ω–Ω—ã—Ö —Å–ª–æ–≤ */
            word-break: break-all; /* –ü–µ—Ä–µ–Ω–æ—Å —Å–ª–æ–≤ */
            white-space: normal; /* –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ–Ω–æ—Å —Ç–µ–∫—Å—Ç–∞ */
        }
    }
</style>

<script>
    let isPlaying = false; // –î–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è
    let audioElements = []; // –ú–∞—Å—Å–∏–≤ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –æ–±—ä–µ–∫—Ç–æ–≤ Audio
    let currentAudioIndex = 0; // –ò–Ω–¥–µ–∫—Å —Ç–µ–∫—É—â–µ–≥–æ –∞—É–¥–∏–æ
    let totalDuration = 0; // –û–±—â–µ–µ –≤—Ä–µ–º—è –≤—Å–µ—Ö –∞—É–¥–∏–æ

    function openModal(imageUrl, content, hasAudio, audioUrls, bookCode) {
        // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
        document.getElementById('modalImage').src = imageUrl;

        // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ç–µ–∫—Å—Ç —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –ø–µ—Ä–µ–Ω–æ—Å–æ–º
        const modalContent = document.getElementById('modalContent');
        modalContent.innerText = content;
        modalContent.style.whiteSpace = 'normal'; // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ–Ω–æ—Å —Ç–µ–∫—Å—Ç–∞
        modalContent.style.wordWrap = 'break-word'; // –ü–µ—Ä–µ–Ω–æ—Å –¥–ª–∏–Ω–Ω—ã—Ö —Å–ª–æ–≤
        modalContent.style.overflowWrap = 'break-word'; // –ü–µ—Ä–µ–Ω–æ—Å –¥–ª–∏–Ω–Ω—ã—Ö —Å–ª–æ–≤

        // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∫–æ–¥ –∫–Ω–∏–≥–∏
        document.getElementById('bookCode').innerText = bookCode || '–ö–æ–¥ –Ω–µ —É–∫–∞–∑–∞–Ω';

        // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞—É–¥–∏–æ
        const audioControls = document.getElementById('audioControls');
        if (hasAudio > 0 && audioUrls) {
            const audioSources = audioUrls.split("|");
            audioElements = [];
            totalDuration = 0; // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –æ–±—â–µ–µ –≤—Ä–µ–º—è

            // –ó–∞–≥—Ä—É–∂–∞–µ–º –∞—É–¥–∏–æ –∏ –≤—ã—á–∏—Å–ª—è–µ–º –æ–±—â–µ–µ –≤—Ä–µ–º—è
            audioSources.forEach((audioUrl) => {
                const audio = new Audio(audioUrl);
                audioElements.push(audio);

                // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∞—É–¥–∏–æ
                audio.addEventListener('loadedmetadata', () => {
                    totalDuration += audio.duration; // –î–æ–±–∞–≤–ª—è–µ–º –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Ç–µ–∫—É—â–µ–≥–æ –∞—É–¥–∏–æ
                    updateTotalDuration(); // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –æ–±—â–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏
                });
            });

            audioControls.innerHTML = `
                <button id="playAudioButton" style="padding: 10px 20px; background-color: #ffffff; color: #003456; border: 2px solid #003456; border-radius: 5px; font-weight: bold; cursor: pointer; transition: background-color 0.3s ease, color 0.3s ease;" onclick="toggleAudio()">
                    –°–ª—É—à–∞—Ç—å —Ñ—Ä–∞–≥–º–µ–Ω—Ç (00:00 / ${formatTime(totalDuration)})
                </button>
            `;
        } else {
            audioControls.innerHTML = ''; // –£–¥–∞–ª—è–µ–º –∫–Ω–æ–ø–∫—É, –µ—Å–ª–∏ –∞—É–¥–∏–æ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç
        }

        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
        document.getElementById('imageModal').style.display = 'flex';
    }

    function closeModal() {
        document.getElementById('imageModal').style.display = 'none';
        stopAllAudio(); // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∞—É–¥–∏–æ –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
    }

    function toggleAudio() {
        const playAudioButton = document.getElementById('playAudioButton');

        if (isPlaying) {
            pauseAllAudio(); // –°—Ç–∞–≤–∏–º –∞—É–¥–∏–æ –Ω–∞ –ø–∞—É–∑—É
            playAudioButton.innerText = `–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ (${formatTime(getCurrentTime())} / ${formatTime(totalDuration)})`;
        } else {
            playAllAudio();
            playAudioButton.innerText = `–û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å (${formatTime(getCurrentTime())} / ${formatTime(totalDuration)})`;
            updateTime(playAudioButton); // –ó–∞–ø—É—Å–∫–∞–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏
        }
    }

    function pauseAllAudio() {
        audioElements.forEach(audio => {
            audio.pause(); // –°—Ç–∞–≤–∏–º –∞—É–¥–∏–æ –Ω–∞ –ø–∞—É–∑—É
        });
        isPlaying = false; // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏
    }

    function updateTime(button) {
        if (!isPlaying) return; // –ï—Å–ª–∏ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ, –≤—ã—Ö–æ–¥–∏–º

        const currentTime = getCurrentTime(); // –¢–µ–∫—É—â–µ–µ –≤—Ä–µ–º—è –≤ —Å–µ–∫—É–Ω–¥–∞—Ö
        const remainingTime = totalDuration - currentTime; // –û—Å—Ç–∞–≤—à–µ–µ—Å—è –≤—Ä–µ–º—è

        button.innerText = `–û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å (${formatTime(currentTime)} / ${formatTime(totalDuration)})`; // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–µ–∫—Å—Ç –∫–Ω–æ–ø–∫–∏

        if (isPlaying) {
            requestAnimationFrame(() => updateTime(button)); // –†–µ–∫—É—Ä—Å–∏–≤–Ω–æ –æ–±–Ω–æ–≤–ª—è–µ–º –≤—Ä–µ–º—è
        }
    }

    function playAllAudio() {
        if (audioElements.length === 0) return; // –ï—Å–ª–∏ –Ω–µ—Ç –∞—É–¥–∏–æ, –Ω–∏—á–µ–≥–æ –Ω–µ –¥–µ–ª–∞–µ–º

        isPlaying = true; // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è
        playAudio(currentAudioIndex); // –í–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º —Ç–µ–∫—É—â–µ–µ –∞—É–¥–∏–æ
    }

    function playAudio(index) {
        if (index >= audioElements.length) {
            stopAllAudio(); // –ï—Å–ª–∏ –∏–Ω–¥–µ–∫—Å –ø—Ä–µ–≤—ã—à–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞—É–¥–∏–æ, –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º
            return;
        }

        const audio = audioElements[index];
        audio.play(); // –í–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º –∞—É–¥–∏–æ

        // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å–æ–±—ã—Ç–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è
        audio.onended = function() {
            playAudio(index + 1); // –í–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º —Å–ª–µ–¥—É—é—â–µ–µ –∞—É–¥–∏–æ
        };
    }

    function stopAllAudio() {
        audioElements.forEach(audio => {
            audio.pause(); // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∞—É–¥–∏–æ
            audio.currentTime = 0; // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –≤—Ä–µ–º—è
        });
        isPlaying = false; // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏
        currentAudioIndex = 0; // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –∏–Ω–¥–µ–∫—Å —Ç–µ–∫—É—â–µ–≥–æ –∞—É–¥–∏–æ
    }

    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏ –≤ MM:SS
    function formatTime(timeInSeconds) {
        const minutes = Math.floor(timeInSeconds / 60);
        const seconds = Math.floor(timeInSeconds % 60);
        return `${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
    }

    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–µ–∫—É—â–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è
    function getCurrentTime() {
        let currentTime = 0;
        audioElements.forEach((audio, index) => {
            if (index < currentAudioIndex) {
                currentTime += audio.duration; // –î–æ–±–∞–≤–ª—è–µ–º –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —É–∂–µ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–Ω—ã—Ö –∞—É–¥–∏–æ
            } else if (index === currentAudioIndex) {
                currentTime += audio.currentTime; // –î–æ–±–∞–≤–ª—è–µ–º —Ç–µ–∫—É—â–µ–µ –≤—Ä–µ–º—è —Ç–µ–∫—É—â–µ–≥–æ –∞—É–¥–∏–æ
            }
        });
        return currentTime;
    }

    let modalLikes = 0;

    function toggleModalLike() {
        modalLikes += 1;
        const likeCountElement = document.getElementById('modalLikeCount');
        likeCountElement.innerText = modalLikes; 
    }

    let likeCounts = {};

    function toggleLike(counter) {
        if (!(counter in likeCounts)) {
            likeCounts[counter] = 0; 
        }
        likeCounts[counter] += 1;

        const likeCountElement = document.getElementById(`likeCount-${counter}`);
        likeCountElement.innerText = likeCounts[counter]; 
    }
</script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    
    <script>
        var swiper = new Swiper('.swiper-container', {
            slidesPerView: 1,
            spaceBetween: 10,
            navigation: {
                nextEl: '.swiper-button-next',
                prevEl: '.swiper-button-prev',
            },
            pagination: {
                el: '.swiper-pagination',
                clickable: true,
            },
            autoplay: {
                delay: 3000,
                disableOnInteraction: false,
            },
        });
    </script>

    <style>
        /* –°—Ç–∏–ª–∏ –¥–ª—è –∞–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç–∏ */
        .news-list {
            list-style: none;
            padding: 0;
            display: flex;
            flex-wrap: wrap;
            justify-content: space-between;
        }

        .news-item {
            border: 1px solid #ddd;
            padding: 20px;
            margin: 10px;
            border-radius: 10px;
            background-color: #f9f9f9;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            width: calc(25% - 20px);
            cursor: pointer;
        }

        .news-image img {
            max-width: 100%;
            height: auto;
            border-radius: 10px;
        }

        .news-title {
            margin-top: 10px;
            color: #007bff;
        }

        .news-author {
            font-size: 14px;
            color: #555;
        }

        .news-reader{
            font-size: 14px;
            color: #555;
        }


        .news-actions {
            margin-top: 10px;
        }

        .news-audio {
            margin-top: 10px;
        }

        /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ */
              /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ */
              @media (max-width: 768px) {
            .news-item {
                width: 100%; /* –ü–æ—Å—Ç—ã –≤ –ª–µ–Ω—Ç–µ –æ—Ç–æ–±—Ä–µ–∂–∞—é—Ç—Å—è –≤ —Å—Ç–æ–ª–±–∏–∫ */
                margin-bottom: 20px; /* –û—Ç—Å—Ç—É–ø –º–µ–∂–¥—É –ø–æ—Å—Ç–∞–º–∏ */
            }
            .news-image img {
                border-radius: 10px; /* –û–∫—Ä—É–≥–ª–µ–Ω–∏–µ —É–≥–ª–æ–≤ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π */
            }
        }

        /* –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ */
        #imageModal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(10px);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        #modalImage {
            flex: 1;
            max-height: 80vh;
            max-width: 100%;
            object-fit: contain;
            margin-right: 20px;
        }
    </style>
{% endblock %}